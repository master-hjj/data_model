{"remainingRequest":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\src\\layout\\components\\Sidebar\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\src\\layout\\components\\Sidebar\\index.vue","mtime":1730289080030},{"path":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720430444311},{"path":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1720430444357},{"path":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1720430444311},{"path":"C:\\Users\\m1980\\Desktop\\buct-kaggle\\data_model\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1720430443512}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBTdGF0ZSB9IGZyb20gInZ1ZXgiOw0KaW1wb3J0IExvZ28gZnJvbSAiLi9Mb2dvIjsNCmltcG9ydCBTaWRlYmFySXRlbSBmcm9tICIuL1NpZGViYXJJdGVtIjsNCmltcG9ydCB2YXJpYWJsZXMgZnJvbSAiQC9hc3NldHMvc3R5bGVzL3ZhcmlhYmxlcy5zY3NzIjsNCmltcG9ydCB7IGdldFJvdXRlcnMgfSBmcm9tICJAL2FwaS9tZW51IjsgLy8g5byV5YWl5o6l5Y+j6K+35rGCDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBjb21wb25lbnRzOiB7IFNpZGViYXJJdGVtLCBMb2dvIH0sDQogICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgLi4ubWFwU3RhdGUoWyJzZXR0aW5ncyJdKSwNCiAgICAgICAgLi4ubWFwR2V0dGVycyhbInNpZGViYXJSb3V0ZXJzIiwgInNpZGViYXIiXSksDQoNCiAgICAgICAgZmlsdGVyZWRTaWRlYmFyUm91dGVycygpIHsNCiAgICAgICAgICAgIGNvbnN0IHVzZXJSb2xlcyA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIucm9sZXM7IC8vIOiOt+WPluW9k+WJjeeUqOaIt+inkuiJsg0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2lkZWJhclJvdXRlcnMNCiAgICAgICAgICAgICAgICAubWFwKHJvdXRlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRSb3V0ZSA9IHsgLi4ucm91dGUgfTsgLy8g5Yib5bu65b2T5YmN6I+c5Y2V6aG555qE5Ymv5pysDQoNCiAgICAgICAgICAgICAgICAgICAgLy8g6YCS5b2S6L+H5ruk5a2Q6I+c5Y2VDQogICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZFJvdXRlLmNoaWxkcmVuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFJvdXRlLmNoaWxkcmVuID0gZmlsdGVyZWRSb3V0ZS5jaGlsZHJlbi5maWx0ZXIoY2hpbGQgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenCBtZXRhLnJvbGVzIOS4uuepuuaIluS4jeWtmOWcqO+8jOWImeaJgOacieinkuiJsuWPr+inge+8m+WQpuWIme+8jOS7hSBtZXRhLnJvbGVzIOWGheeahOinkuiJsuWPr+ingQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhY2hpbGQubWV0YT8ucm9sZXMgfHwgY2hpbGQubWV0YS5yb2xlcy5sZW5ndGggPT09IDAgfHwgY2hpbGQubWV0YS5yb2xlcy5zb21lKHJvbGUgPT4gdXNlclJvbGVzLmluY2x1ZGVzKHJvbGUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8g5Yik5pat54i26I+c5Y2V6aG55pys6Lqr55qE5Y+v6KeB5oCnDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUm91dGVWaXNpYmxlID0gIWZpbHRlcmVkUm91dGUubWV0YT8ucm9sZXMgfHwgDQogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZFJvdXRlLm1ldGEucm9sZXMubGVuZ3RoID09PSAwIHx8IA0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRSb3V0ZS5tZXRhLnJvbGVzLnNvbWUocm9sZSA9PiB1c2VyUm9sZXMuaW5jbHVkZXMocm9sZSkpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIOS7hei/lOWbnuespuWQiOinkuiJsuadg+mZkOeahOi3r+eUseWSjOWtkOi3r+eUsQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGZpbHRlcmVkUm91dGUuY2hpbGRyZW4gJiYgZmlsdGVyZWRSb3V0ZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB8fCBpc1JvdXRlVmlzaWJsZSA/IGZpbHRlcmVkUm91dGUgOiBudWxsOw0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmZpbHRlcihyb3V0ZSA9PiByb3V0ZSAhPT0gbnVsbCk7IC8vIOa4hemZpOaXoOaViOi3r+eUsQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgYWN0aXZlTWVudSgpIHsNCiAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gdGhpcy4kcm91dGU7DQogICAgICAgICAgICBjb25zdCB7IG1ldGEsIHBhdGggfSA9IHJvdXRlOw0KICAgICAgICAgICAgaWYgKG1ldGEuYWN0aXZlTWVudSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBtZXRhLmFjdGl2ZU1lbnU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcGF0aDsNCiAgICAgICAgfSwNCiAgICAgICAgc2hvd0xvZ28oKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuc2V0dGluZ3Muc2lkZWJhckxvZ287DQogICAgICAgIH0sDQogICAgICAgIHZhcmlhYmxlcygpIHsNCiAgICAgICAgICAgIHJldHVybiB2YXJpYWJsZXM7DQogICAgICAgIH0sDQogICAgICAgIGlzQ29sbGFwc2UoKSB7DQogICAgICAgICAgICByZXR1cm4gIXRoaXMuc2lkZWJhci5vcGVuZWQ7DQogICAgICAgIH0NCiAgICB9LA0KICAgIG1vdW50ZWQoKSB7DQogICAgICAgIGdldFJvdXRlcnMoKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmjqXlj6Pov5Tlm57nmoTmlbDmja46IiwgcmVzcG9uc2UuZGF0YSk7IC8vIOaJk+WNsOaOpeWPo+i/lOWbnueahOaVsOaNrg0KICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKCLojrflj5bot6/nlLHmlbDmja7lpLHotKU6IiwgZXJyb3IpOw0KICAgICAgICB9KTsNCiAgICB9DQp9Ow0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/layout/components/Sidebar","sourcesContent":["<template>\r\n    <div :class=\"{'has-logo':showLogo}\" :style=\"{ backgroundColor: settings.sideTheme === 'theme-dark' ? variables.menuBackground : variables.menuLightBackground }\">\r\n        <logo v-if=\"showLogo\" :collapse=\"isCollapse\" />\r\n        <el-scrollbar :class=\"settings.sideTheme\" wrap-class=\"scrollbar-wrapper\">\r\n            <el-menu\r\n                :default-active=\"activeMenu\"\r\n                :collapse=\"isCollapse\"\r\n                :background-color=\"settings.sideTheme === 'theme-dark' ? variables.menuBackground : variables.menuLightBackground\"\r\n                :text-color=\"settings.sideTheme === 'theme-dark' ? variables.menuColor : variables.menuLightColor\"\r\n                :unique-opened=\"true\"\r\n                :active-text-color=\"settings.theme\"\r\n                :collapse-transition=\"false\"\r\n                mode=\"vertical\"\r\n            >\r\n                <sidebar-item\r\n                    v-for=\"(route, index) in filteredSidebarRouters\"\r\n                    :key=\"route.path + index\"\r\n                    :item=\"route\"\r\n                    :base-path=\"route.path\"\r\n                />\r\n            </el-menu>\r\n        </el-scrollbar>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapState } from \"vuex\";\r\nimport Logo from \"./Logo\";\r\nimport SidebarItem from \"./SidebarItem\";\r\nimport variables from \"@/assets/styles/variables.scss\";\r\nimport { getRouters } from \"@/api/menu\"; // 引入接口请求\r\n\r\nexport default {\r\n    components: { SidebarItem, Logo },\r\n    computed: {\r\n        ...mapState([\"settings\"]),\r\n        ...mapGetters([\"sidebarRouters\", \"sidebar\"]),\r\n\r\n        filteredSidebarRouters() {\r\n            const userRoles = this.$store.state.user.roles; // 获取当前用户角色\r\n            return this.sidebarRouters\r\n                .map(route => {\r\n                    const filteredRoute = { ...route }; // 创建当前菜单项的副本\r\n\r\n                    // 递归过滤子菜单\r\n                    if (filteredRoute.children) {\r\n                        filteredRoute.children = filteredRoute.children.filter(child => {\r\n                            // 如果 meta.roles 为空或不存在，则所有角色可见；否则，仅 meta.roles 内的角色可见\r\n                            return !child.meta?.roles || child.meta.roles.length === 0 || child.meta.roles.some(role => userRoles.includes(role));\r\n                        });\r\n                    }\r\n\r\n                    // 判断父菜单项本身的可见性\r\n                    const isRouteVisible = !filteredRoute.meta?.roles || \r\n                        filteredRoute.meta.roles.length === 0 || \r\n                        filteredRoute.meta.roles.some(role => userRoles.includes(role));\r\n\r\n                    // 仅返回符合角色权限的路由和子路由\r\n                    return (filteredRoute.children && filteredRoute.children.length > 0) || isRouteVisible ? filteredRoute : null;\r\n                })\r\n                .filter(route => route !== null); // 清除无效路由\r\n        },\r\n\r\n\r\n        activeMenu() {\r\n            const route = this.$route;\r\n            const { meta, path } = route;\r\n            if (meta.activeMenu) {\r\n                return meta.activeMenu;\r\n            }\r\n            return path;\r\n        },\r\n        showLogo() {\r\n            return this.$store.state.settings.sidebarLogo;\r\n        },\r\n        variables() {\r\n            return variables;\r\n        },\r\n        isCollapse() {\r\n            return !this.sidebar.opened;\r\n        }\r\n    },\r\n    mounted() {\r\n        getRouters().then(response => {\r\n            console.log(\"接口返回的数据:\", response.data); // 打印接口返回的数据\r\n        }).catch(error => {\r\n            console.error(\"获取路由数据失败:\", error);\r\n        });\r\n    }\r\n};\r\n</script>\r\n\r\n"]}]}